<script type="text/javascript" src="${resourcePath}/adminlte/plugins/jvectormap/jquery.vector-map.js"></script>
<script type="text/javascript"  src="${resourcePath}/adminlte/plugins/jvectormap/china-zh.js"></script>
   
    
  <section class="content-header">
      <ol class="breadcrumb">
			<li><a href="${basePath}"><i class="fa fa-dashboard"></i> 首页</a></li>
			<li><a href="#">监控总览</a></li>
			<li class="active">业务健康</li>
		</ol>
    </section>

       <!-- Main content -->
    <section class="content">
		
        <div class="row">
        	<section class="content-header">
		<span class=" btn-default">请选择:</span>
		<div class="btn-group">
                <button type="button" class="btn btn-default" style="background-color:#00c0ef">当日</button>
                <button type="button" class="btn btn-default">当月</button>
                <button type="button" class="btn btn-default">季度</button>
                <button type="button" class="btn btn-default">年</button>
        </div>
    </section>
    <section class="content">
    	<div class="row">
        <!-- ./col -->
        <div class="col-lg-4 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-aqua">
            <div class="inner">
              <h3>${totalprice!}元</h3>
              <p>销售额</p>
            </div>
            <div class="icon">
              <i class="ion ion-pie-graph"></i>
            </div>
            
          </div>
        </div>
        
        <div class="col-lg-4 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-aqua">
            <div class="inner">
              <h3>${ordernum!}单</h3>
              <p>订单数量</p>
            </div>
            <div class="icon">
              <i class="fa fa-shopping-cart"></i>
            </div>
            
          </div>
        </div>
        
        <div class="col-lg-4 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-aqua">
            <div class="inner">
              <h3>${kedanjia!}元</h3>
              <p>客单价</p>
            </div>
            <div class="icon">
              <i class="ion ion-person-add"></i>
            </div>
            
          </div>
        </div>
        <!-- ./col -->
      </div>
      <div class="row">
      <div class="col-md-8">
      	<div class="box box-success">
            <div class="box-header with-border">
              <h3 class="box-title">当前订单监控</h3>

              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
              </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body no-padding">
              <div class="row">
                <div class="col-md-10 col-sm-7">
                  <div class="pad">
                    <!-- Map will be created here -->
                    <div id="china-map-markers" style=" height: 650px;"></div>
                  </div>
                </div>
                <!-- /.col -->
                <div class="col-md-2 col-sm-3">
                  <div class="pad box-pane-right bg-green" style="min-height: 123px">
                    <div class="description-block margin-bottom">
                      <h2 class="">${正常订单!}</h2>
                      <span class="description-text">正常订单</span>
                    </div>
                    </div>
                    
                    <!-- /.description-block -->
                    <div class="pad box-pane-right bg-yellow" style="min-height: 123px">
                    <div class="description-block margin-bottom">
                      <h2 class="">${预警订单!}</h2>
                      <span class="description-text">预警订单</span>
                    </div>
                    </div>
                    <!-- /.description-block -->
                    
                    <div class="pad box-pane-right bg-red" style="min-height: 123px">
                    <div class="description-block">
                      
                      <a href="javascript:void(0);" onclick="refleshChina()" style="color:black"><h2 class="">${警告订单!}</h2></a>
                      <span class="description-text">警告订单</span>
                    </div>
                    <!-- /.description-block -->
                  </div>
                  <div class="pad box-pane-right" style="background-color:#FFFFFF;min-height: 30px">
                  	
                  </div>
                  		警告颜色：
                  <div class="pad box-pane-right" style="background-color:#FFCFCA;min-height: 50px">
                  	<div class="description-block">
                      <span class="description-text">警告单数=1</span>
                    </div>
                  </div>
                  <div class="pad box-pane-right" style="background-color:#FDA4AA;min-height: 50px">
                  	<div class="description-block">
                      <span class="description-text">1&lt;警告单数&lt;=10</span>
                    </div>
                  </div>
                  <div class="pad box-pane-right" style="background-color:#FF6464;min-height: 50px">
                  	<div class="description-block">
                      <span class="description-text">10&lt;警告单数&lt;=100</span>
                    </div>
                  </div>
                  <div class="pad box-pane-right" style="background-color:#FD0C06;min-height: 50px">
                  	<div class="description-block">
                      <span class="description-text">100&lt;警告单数</span>
                    </div>
                  </div>
                </div>
                <!-- /.col -->
              </div>
              <!-- /.row -->
            </div>
            <!-- /.box-body -->
          </div>
      </div>

		<div class="col-md-4">
          <div class="box box-default">
            <div class="box-header with-border">
              <i class="fa fa-bullhorn"></i>

              <h3 class="box-title">当日购物车与产品监控</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <div class="callout callout-danger">
                <h4>产品状态异常</h4>

                <p>当日存在9条产品异常记录</p>
                  <a href="#" onClick="goProductStatus()" class="small-box-footer">
                                                   查询产品状态监控 <i class="fa fa-arrow-circle-right"></i>
            </a>
              </div>
              <div class="callout callout-success">
                <h4>购物车状态正常</h4>

                <p> </p>
                <a href="#" onClick="goCartStatus()" class="small-box-footer">
              	查询购物车状态监控 <i class="fa fa-arrow-circle-right"></i>
              </div>
            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
        </div>


      </div>
      
    
    </section>
      </div>
    </section>
    <!-- /.content -->
    
    <script>
	   //map
	   
	   
	   //数据可以动态生成，格式自己定义，cha对应china-zh.js中省份的简称
       var dataStatus =  ${jinggaoData!};
		
       $('#china-map-markers').vectorMap({ map: 'china_zh',
           color: "#D2D6DE", //地图颜色
           onLabelShow: function (event, label, code) {//动态显示内容
               $.each(dataStatus, function (i, items) {
                   if (code == items.cha) {
                       label.html(items.name + "警告订单："+items.jinggao);
                   }
               });
           },
			onRegionClick: function(event, code){
			    $.each(dataStatus, function (i, items) {
		　　　　　　　　if ((code == items.cha) && (items.jinggao > 0)) {
					$("div.jvectormap-label").remove();
		　　　　　　　　　　loadPage("${basePath}/poc/statusoverview?province="+encodeURI(encodeURI(items.name)));
		　　　　　　　　}
		　　　　　　});
			}
       })

		
       $.each(dataStatus, function (i, items) {
			var color= "'#D2D6DE'";
           if (items.jinggao == 1) {
               color = "'#FFCFCA'";
           }
			else if (items.jinggao > 1 && items.jinggao <= 10) {
               color = "'#FDA4AA'";
           }
			else if (items.jinggao > 10 && items.jinggao <= 100) {
               color = "'#FF6464'";
           }else if(items.jinggao >100){
				color = "'#FD0C06'";
			}
			var josnStr = "{" + items.cha + ":"+color+"}";
           $('#china-map-markers').vectorMap('set', 'colors', eval('(' + josnStr + ')'));
       });
	   
	   
          function refleshChina(){
        	  loadPage("${basePath}/poc/statusoverview"); 
          }
          
          function refleshOperate(code){
        	  loadPage("${basePath}/poc/orderStatus/"+code); 
          }
          
          function goProductStatus(){
        	  loadPage('${basePath}/poc/productStatus');
          }
          
          function goCartStatus(){
        	  loadPage('${basePath}/poc/cartStatus');
          }
          
          //$("div.jvectormap-label").style.display="none";

</script>